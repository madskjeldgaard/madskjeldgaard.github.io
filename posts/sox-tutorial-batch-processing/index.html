<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>
        SoX tutorial: Batch processing audio on the command line ::
        Mads Kjeldgaard — Composer and developer
      </title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="To make full use of SoX&#39; potential for batch processing we will be using a bit of command line wizardry.
The idea is to put our sox command inside of a for-loop which iterates over all audio files in the folder you are currently in. If you are unsure of what folder your terminal is executing from, you can write pwd to see it&amp;rsquo;s full path and ls to see the folder&amp;rsquo;s contents."
/>
<meta
  name="keywords"
  content="computer music, supercollider, rust, vim, linux"
/>
<meta name="robots" content="noodp" />
<link rel="canonical" href="http://madskjeldgaard.dk/posts/sox-tutorial-batch-processing/" />





<link rel="stylesheet" href="http://madskjeldgaard.dk/assets/style.css" />

<link rel="stylesheet" href="http://madskjeldgaard.dk/style.css" />


<link
  rel="apple-touch-icon-precomposed"
  sizes="144x144"
  href="http://madskjeldgaard.dk/img/apple-touch-icon-144-precomposed.png"
/>
<link rel="shortcut icon" href="http://madskjeldgaard.dk/img/favicon.png" />


<link href="http://madskjeldgaard.dk/assets/fonts/Inter-Italic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="http://madskjeldgaard.dk/assets/fonts/Inter-Regular.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="http://madskjeldgaard.dk/assets/fonts/Inter-Medium.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="http://madskjeldgaard.dk/assets/fonts/Inter-MediumItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="http://madskjeldgaard.dk/assets/fonts/Inter-Bold.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="http://madskjeldgaard.dk/assets/fonts/Inter-BoldItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">


<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="http://madskjeldgaard.dk/img/small/states-of-emergency.jpg"/>

<meta name="twitter:title" content="SoX tutorial: Batch processing audio on the command line"/>
<meta name="twitter:description" content="To make full use of SoX&#39; potential for batch processing we will be using a bit of command line wizardry.
The idea is to put our sox command inside of a for-loop which iterates over all audio files in the folder you are currently in. If you are unsure of what folder your terminal is executing from, you can write pwd to see it&rsquo;s full path and ls to see the folder&rsquo;s contents."/>



<meta property="og:title" content="SoX tutorial: Batch processing audio on the command line" />
<meta property="og:description" content="To make full use of SoX&#39; potential for batch processing we will be using a bit of command line wizardry.
The idea is to put our sox command inside of a for-loop which iterates over all audio files in the folder you are currently in. If you are unsure of what folder your terminal is executing from, you can write pwd to see it&rsquo;s full path and ls to see the folder&rsquo;s contents." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://madskjeldgaard.dk/posts/sox-tutorial-batch-processing/" /><meta property="og:image" content="http://madskjeldgaard.dk/img/small/states-of-emergency.jpg"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-04-26T10:07:25+02:00" />
<meta property="article:modified_time" content="2020-04-26T10:07:25+02:00" /><meta property="og:site_name" content="Mads Kjeldgaard" />







  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a
  href="/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >madskjeldgaard</span
    >
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/pages/about">about</a></li>
        
      
        
          <li><a href="/pages/contact">contact</a></li>
        
      
        
          <li><a href="/posts">posts</a></li>
        
      
        
          <li><a href="/pages/software">software</a></li>
        
      
        
          <li><a href="/pages/work">sound</a></li>
        
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/pages/about">about</a></li>
      
    
      
        <li><a href="/pages/contact">contact</a></li>
      
    
      
        <li><a href="/posts">posts</a></li>
      
    
      
        <li><a href="/pages/software">software</a></li>
      
    
      
        <li><a href="/pages/work">sound</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none" />
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg
  class="theme-toggler"
  width="24"
  height="24"
  viewBox="0 0 48 48"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"
  />
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h1 class="post-title">SoX tutorial: Batch processing audio on the command line</h1>
    <div class="post-meta">
      
        <span class="post-date">
          2020-04-26
        </span>

        
          
        
      

      


      
    </div>

    
      <span class="post-tags">
        
          <a href="http://madskjeldgaard.dk/tags/tutorial/">#tutorial</a>&nbsp;
        
          <a href="http://madskjeldgaard.dk/tags/sox/">#sox</a>&nbsp;
        
      </span>
    

    

    <div class="post-content">
      
        
        <h2>Table of Contents</h2>
        <aside class="table-of-contents"><nav id="TableOfContents">
  <ul>
    <li><a href="#normalize">Normalize</a></li>
    <li><a href="#channel-conversion">Channel conversion</a></li>
    <li><a href="#convert-to-48khz-sample-rate">Convert to 48khz sample rate</a></li>
    <li><a href="#convert-to-16bit">Convert to 16bit</a></li>
  </ul>
</nav></aside>
        
      
      <p>To make full use of SoX' potential for batch processing we will be using a bit of command line wizardry.</p>
<p>The idea is to put our sox command inside of a for-loop which iterates over all audio files in the folder you are currently in. If you are unsure of what folder your terminal is executing from, you can write <code>pwd</code> to see it&rsquo;s full path and <code>ls</code> to see the folder&rsquo;s contents.</p>
<h1 id="for-loop">
  For-loop
  <a href="#for-loop" class="h-anchor" aria-hidden="true">#</a>
</h1>
<p>The structure of our for-loop-command will look something like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#66d9ef">for</span> file in *.wav; <span style="color:#66d9ef">do</span> command $file; <span style="color:#66d9ef">done</span>
</code></pre></div><p>This needs a bit of explanation. What we see here is shell scripting where commands (or lines of code you could say) are seperated by semi colons.</p>
<p>The first bit of this command (<code>for file in *.wav</code>) will find all files in the current directory containing the suffix <code>.wav</code>. Note that this is case-sensitive, so if you want WAV files to be converted change it to <code>*.WAV</code>, and so on. The smart thing about this is that each file inside of the for-loop will accessible as the variable <code>$file</code>.</p>
<p>The second bit of the command is the meat of it. Here we execute our sox command like we have done previously in this tutorial, with the main difference being we put <code>do</code> in front of it - this is a way to tell our for loop that this is supposed to happen on each file we find.</p>
<p>The third bit is self-explanatory: <code>done</code>.</p>
<p>We will be operating on .wav-files here, but you can easily change the commands to target .aiff files or some other supported file format.</p>
<h1 id="batch-processing-examples">
  Batch processing examples
  <a href="#batch-processing-examples" class="h-anchor" aria-hidden="true">#</a>
</h1>
<h2 id="normalize">
  Normalize
  <a href="#normalize" class="h-anchor" aria-hidden="true">#</a>
</h2>
<p>To normalize a file in SoX we need to apply the <code>norm</code> effect which only takes one parameter which is the sound level to normalize to. A reasonable normalization level is -0.1 dB so let us use that in our conversion process.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#66d9ef">for</span> file in *.wav; <span style="color:#66d9ef">do</span> sox <span style="color:#e6db74">&#34;</span>$file<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;n_</span>$file<span style="color:#e6db74">&#34;</span> norm -0.1; <span style="color:#66d9ef">done</span>
</code></pre></div><p>Notice that what we do here is non-destructive. The normalized files produced by this process have the same file names as the input files but with a &ldquo;n_&rdquo; at the beginning to signify that it has been normalized.</p>
<h2 id="channel-conversion">
  Channel conversion
  <a href="#channel-conversion" class="h-anchor" aria-hidden="true">#</a>
</h2>
<p>Another useful effect included with SoX is <code>channels</code>, this makes it possible for us to specify the number of channels in the output file. This is useful if for example you need to convert a folder of files to mono, this can be done in a manner similar to the above:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#66d9ef">for</span> file in *.wav; <span style="color:#66d9ef">do</span> sox <span style="color:#e6db74">&#34;</span>$file<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;mono_</span>$file<span style="color:#e6db74">&#34;</span> channels 1; <span style="color:#66d9ef">done</span>
</code></pre></div><h2 id="convert-to-48khz-sample-rate">
  Convert to 48khz sample rate
  <a href="#convert-to-48khz-sample-rate" class="h-anchor" aria-hidden="true">#</a>
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#66d9ef">for</span> file in *.wav; <span style="color:#66d9ef">do</span> sox <span style="color:#e6db74">&#34;</span>$file<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;48khz_</span>$file<span style="color:#e6db74">&#34;</span> rate 48k; <span style="color:#66d9ef">done</span>
</code></pre></div><h2 id="convert-to-16bit">
  Convert to 16bit
  <a href="#convert-to-16bit" class="h-anchor" aria-hidden="true">#</a>
</h2>
<p>Now, this is slightly different because when converting bit-depth we need to use a command line flag instead of an effect. Normally, SoX will use the detected bit-depth of the input file as the bit-depth of the output file, but you can force SoX to change it to something else (like 16 bit) by adding a <code>-b 16</code> in between the file names (or <code>-b 24</code> for 24 bit).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#66d9ef">for</span> file in *.wav; <span style="color:#66d9ef">do</span> sox <span style="color:#e6db74">&#34;</span>$file<span style="color:#e6db74">&#34;</span> -b <span style="color:#ae81ff">16</span> <span style="color:#e6db74">&#34;16bit_</span>$file<span style="color:#e6db74">&#34;</span>; <span style="color:#66d9ef">done</span>
</code></pre></div><h1 id="where-to-go-from-here">
  Where to go from here?
  <a href="#where-to-go-from-here" class="h-anchor" aria-hidden="true">#</a>
</h1>
<p>I would highly encourage you to go back and read the SoX manual (<code>man sox</code>, remember?) because there really is a plethora of fun and useful things you can do with SoX in a for-loop.</p>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h"
              >Read other posts</span
            >
            <hr />
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="http://madskjeldgaard.dk/posts/sox-tutorial-sox-on-android/">
                  <span class="button__icon">←</span>
                  <span class="button__text">SoX tutorial: SoX on Android</span>
                </a>
              </span>
            
            
              <span class="button next">
                <a href="http://madskjeldgaard.dk/posts/sox-tutorial-split-by-silence/">
                  <span class="button__text">SoX tutorial: Split by silence</span>
                  <span class="button__icon">→</span>
                </a>
              </span>
            
          </div>
        </div>
      
    

    
      
        

      
    
  </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <a
  href="/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >madskjeldgaard</span
    >
    <span class="logo__cursor"></span>
  
</a>

      <div class="copyright">
        <span
          >© 2022 Powered by
          <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a></span
        >
        <span
          >Theme created by
          <a href="https://twitter.com/panr" target="_blank" rel="noopener">panr</a></span
        >
      </div>
    
  </div>
</footer>

<script src="http://madskjeldgaard.dk/assets/main.js"></script>
<script src="http://madskjeldgaard.dk/assets/prism.js"></script>


      
    </div>

    
  </body>
</html>
